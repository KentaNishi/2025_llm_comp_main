# DPO Stage 2 設定
# ベースモデルに対して直接DPOを適用する（SFTアダプタなし）

# 1. モデル関連
DPO_BASE_MODEL=Qwen/Qwen3-4B-Instruct-2507
DPO_SFT_ADAPTER_DIR=
DPO_DATASET_ID=u-10bei/dpo-dataset-qwen-cot
DPO_OUT_DIR=~/workspace/2025_llm_comp_main/output/dpo_base_model

# 2. シーケンス長
DPO_MAX_SEQ_LEN=2048

# 3. LoRA Config
DPO_LORA_R=8
DPO_LORA_ALPHA=16
DPO_LORA_DROPOUT=0
DPO_LORA_TARGET_MODULES=q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj

# 4. DPO Hyperparams
DPO_LR=1e-7
DPO_BETA=0.1
DPO_EPOCHS=1
DPO_MAX_STEPS=-1
DPO_PER_DEVICE_TRAIN_BS=2
DPO_GRAD_ACCUM=4
DPO_MAX_LENGTH=1024
DPO_MAX_PROMPT_LENGTH=512
DPO_WARMUP_RATIO=0.1
DPO_WEIGHT_DECAY=0.01
DPO_SEED=42

# 5. Logging / Save
DPO_LOGGING_STEPS=50
DPO_SAVE_STEPS=100
DPO_SAVE_TOTAL_LIMIT=2

# MLflow実験管理
MLFLOW_EXPERIMENT_NAME=dpo-base-model-stage2
