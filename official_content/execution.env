# -----------------------------
# 環境変数の設定
# -----------------------------
# 下記の値を書き換えることで、コード本体を編集せずに設定を変更できます。

# 1. モデル・データセット関連
SFT_BASE_MODEL=Qwen/Qwen3-4B-Instruct-2507
SFT_DATASET_ID=u-10bei/structured_data_with_cot_dataset_512_v2
SFT_OUT_LORA_DIR=/content/lora_structeval_t_qwen3_4b

# 2. 学習の基本パラメータ
SFT_SEED=3407
SFT_VAL_RATIO=0.05
SFT_MAX_SEQ_LEN=512

# 3. LoRA (アダプタ) 設定
SFT_LORA_R=64
SFT_LORA_ALPHA=128
SFT_LORA_DROPOUT=0
SFT_LORA_TARGET_MODULES=q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj

# 4. ハイパーパラメータ
SFT_EPOCHS=1
SFT_PER_DEVICE_TRAIN_BS=2
SFT_PER_DEVICE_EVAL_BS=2
SFT_GRAD_ACCUM=8
SFT_LR=1e-6
SFT_WARMUP_RATIO=0.1
SFT_WEIGHT_DECAY=0.05

# 5. ステップ・保存設定
SFT_MAX_STEPS=-1  # -1でエポックベース。動作確認時は 10 などに。
SFT_LOGGING_STEPS=10
SFT_EVAL_STEPS=50
SFT_SAVE_STEPS=100
SFT_SAVE_TOTAL_LIMIT=2

# 6. 特殊学習設定 (CoTマスク・アップサンプリング)
SFT_MASK_COT=1  # "1" で有効, "0" で無効
SFT_OUTPUT_MARKERS=Output:,OUTPUT:,Final:,Answer:,Result:,Response:
SFT_OUTPUT_LEARN_MODE=after_marker  # "after_marker" または "from_marker"
SFT_USE_UPSAMPLING=0  # "1" で有効, "0" で無効  # データ2-1,2-2,2-3 専用
SFT_UPSAMPLE_RULES='{"xml_to_yaml": 2.0}'  # 例: '{"json_to_xml": 1.8, "text_to_yaml": 1.6}' # データ2-1,2-2,2-3 専用

